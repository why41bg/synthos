## 1. åµŒå¥—æ¶ˆæ¯ï¼ˆåˆç§°å¼•ç”¨/æåŠï¼‰çš„ç»“æ„

å¯¹äºä¸‹é¢çš„å›¾ç‰‡æ‰€ç¤ºæ¶ˆæ¯:

![alt text](image.png)

å…¶pbç›´æ¥è½¬ä¸ºutf8å­—ç¬¦ä¸²ä¸ºï¼š

```
ï¿½ï¿½ï¿½ï¿½ï¿½u_2F9cgITHgkC0Yo32nIht9wï¿½ï¿½Ë“ï¿½ï¿½Å‡ï¿½ï¿½hï¿½ï¿½Ğ’ï¿½Ø’ã…·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Çœï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ó“ï¿½ï¿½Å‡ï¿½ï¿½hï¿½ï¿½^ï¿½ï¿½Ì“ï¿½ï¿½Å‡ï¿½ï¿½hï¿½ï¿½ï¿½Jæ‰¾ä¸€ä½æ˜å¤©æ—©å…«åˆ°12çš„ä»£è¯¾ï¼Œå¯èƒ½éœ€è¦å¸®å¿™æ‰¾è€å¸ˆé—®ç‚¹äº‹ï¿½ï¿½ï¿½ï¿½Ñ“ï¿½ï¿½Å‡ï¿½ï¿½hï¿½ï¿½ï¿½ğŸ˜­ï¿½ï¿½
```

å…¶pbæŒ‰ç…§ `messageSegment.proto` è§£ç åçš„jså¯¹è±¡ç»“æ„å¦‚ä¸‹ï¼š

```js
[
    {
        senderId: "u_2F9cgITHgkC0Yo32nIht9w",
        receiverId: "",
        messageId: "7559956338863016395",
        messageType: 7,
        messageText: "",
        fileName: "",
        filePath: "",
        fileSize: "0",
        file10MMD5: "",
        fileSha: "",
        fileSha3: "",
        videotime: 0,
        picWidth: 0,
        picHeight: 0,
        thumbWidth: 0,
        thumbHeight: 0,
        thumbSizeVideo: 0,
        picType: 0,
        thumbfilename: "",
        originImageMd5: "",
        fileUuid: "",
        imageUrlLow: "",
        imageUrlHigh: "",
        imageUrlOrigin: "",
        imageText: "",
        thumbMD5: "",
        duration: 0,
        pttText: "",
        waveAmplitudes: "",
        picThumbPath: "",
        replyMsgId: "0", // å¼•ç”¨çš„æ¶ˆæ¯çš„messageId, ä¼¼ä¹å§‹ç»ˆä¸º0ï¼ŒåŸå› æœªçŸ¥
        replyMsgSeq: 18672,
        replyMsgTime: 1741538019,
        receiverUid: 0,
        replyMsgContent: "",
        replySenderNick: "",
        replyMessage: {
            senderId: "",
            receiverId: "",
            messageId: "7559956338863016396",
            messageType: 1,
            messageText: "æ‰¾ä¸€ä½æ˜å¤©æ—©å…«åˆ°12çš„ä»£è¯¾ï¼Œå¯èƒ½éœ€è¦å¸®å¿™æ‰¾è€å¸ˆé—®ç‚¹äº‹",
            fileName: "",
            filePath: "",
            fileSize: "0",
            file10MMD5: "",
            fileSha: "",
            fileSha3: "",
            videotime: 0,
            picWidth: 0,
            picHeight: 0,
            thumbWidth: 0,
            thumbHeight: 0,
            thumbSizeVideo: 0,
            picType: 0,
            thumbfilename: "",
            originImageMd5: "",
            fileUuid: "",
            imageUrlLow: "",
            imageUrlHigh: "",
            imageUrlOrigin: "",
            imageText: "",
            thumbMD5: "",
            duration: 0,
            pttText: "",
            waveAmplitudes: "",
            picThumbPath: "",
            replyMsgId: "0",
            replyMsgSeq: 0,
            replyMsgTime: 0,
            receiverUid: 0,
            replyMsgContent: "",
            replySenderNick: "",
            replyMessage: null,
            emojiId: 0,
            emojiText: "",
            withdrawSuffix: "",
            applicationMessage: "",
            callStatusText: "",
            callText: "",
            feedTitle: null,
            feedContent: null,
            feedUrl: "",
            feedLogoUrl: "",
            feedPublisherUid: 0,
            feedJumpInfo: "",
            feedPublisherId: "",
            noticeInfo: "",
            noticeInfo2: "",
            xmlMessage: "",
            sendTimestamp: 0,
            thumbSize: 0
        },
        emojiId: 0,
        emojiText: "",
        withdrawSuffix: "",
        applicationMessage: "",
        callStatusText: "",
        callText: "",
        feedTitle: null,
        feedContent: null,
        feedUrl: "",
        feedLogoUrl: "",
        feedPublisherUid: 0,
        feedJumpInfo: "",
        feedPublisherId: "",
        noticeInfo: "",
        noticeInfo2: "",
        xmlMessage: "",
        sendTimestamp: 0,
        thumbSize: 0
    },
    {
        senderId: "",
        receiverId: "",
        messageId: "7559956338863016401",
        messageType: 1,
        messageText: "ğŸ˜­",
        fileName: "",
        filePath: "",
        fileSize: "0",
        file10MMD5: "",
        fileSha: "",
        fileSha3: "",
        videotime: 0,
        picWidth: 0,
        picHeight: 0,
        thumbWidth: 0,
        thumbHeight: 0,
        thumbSizeVideo: 0,
        picType: 0,
        thumbfilename: "",
        originImageMd5: "",
        fileUuid: "",
        imageUrlLow: "",
        imageUrlHigh: "",
        imageUrlOrigin: "",
        imageText: "",
        thumbMD5: "",
        duration: 0,
        pttText: "",
        waveAmplitudes: "",
        picThumbPath: "",
        replyMsgId: "0",
        replyMsgSeq: 0,
        replyMsgTime: 0,
        receiverUid: 0,
        replyMsgContent: "",
        replySenderNick: "",
        replyMessage: null,
        emojiId: 0,
        emojiText: "",
        withdrawSuffix: "",
        applicationMessage: "",
        callStatusText: "",
        callText: "",
        feedTitle: null,
        feedContent: null,
        feedUrl: "",
        feedLogoUrl: "",
        feedPublisherUid: 0,
        feedJumpInfo: "",
        feedPublisherId: "",
        noticeInfo: "",
        noticeInfo2: "",
        xmlMessage: "",
        sendTimestamp: 0,
        thumbSize: 0
    }
];
```

è¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸¤æ®µå¼ç»“æ„ï¼Œç¬¬ä¸€æ®µæ˜¯messageTypeä¸º7çš„å¼•ç”¨ï¼ˆå¼•ç”¨äº†ä¸€æ¡å…ˆå‰å‘é€çš„æ¶ˆæ¯ï¼‰ï¼Œç¬¬äºŒæ®µæ˜¯messageTypeä¸º1çš„æ–‡æœ¬æ¶ˆæ¯æ­£æ–‡ã€‚

## 2. atæ¶ˆæ¯çš„ç»“æ„

![alt text](image-1.png)

ä¸‹é¢çš„jså·²ç»å»é™¤äº†ä¸€äº›å†—ä½™å­—æ®µï¼Œä¾¿äºå±•ç¤ºã€‚

```js
[
    // å¼•ç”¨
    {
        senderId: "u_UYvwXOkWFBLmrK9vCpIZdQ",
        receiverId: "",
        messageId: "7559957795182421197",
        messageType: 7,
        messageText: "",    
        replyMsgSeq: 960450,
        replyMsgTime: 3880599217,
        receiverUid: 0,
        replyMsgContent: "",
        replySenderNick: "",
        replyMessage: {
            senderId: "",
            receiverId: "",
            messageId: "7559957795182421199",
            messageType: 1,
            messageText: " å¸é¼»å™¨æœ‰æ— ç”¨å¤„",
            replyMsgId: "0",
            replyMsgSeq: 0,
            replyMsgTime: 0,
            receiverUid: 0,
            replyMsgContent: "",
            replySenderNick: "",
            replyMessage: null,
        },
    },
    // @å…¶ä»–ç”¨æˆ·çš„æ–‡æœ¬ç‰‡æ®µ
    {
        senderId: "",
        receiverId: "",
        messageId: "7559957795182421204",
        messageType: 1,
        messageText: "@NANNNnNnAANaNanaNnnnaaNNNaAannanan",
        replyMsgId: "0",
        replyMsgSeq: 0,
        replyMsgTime: 0,
        receiverUid: 0,
        replyMsgContent: "",
        replySenderNick: "",
        replyMessage: null,
    },
    // @ç‰‡æ®µä¸æ­£æ–‡ä¹‹é—´æœ‰ä¸€ä¸ªç©ºæ ¼
    {
        senderId: "",
        receiverId: "",
        messageId: "7559957795182421205",
        messageType: 1,
        messageText: " ",
        replyMsgId: "0",
        replyMsgSeq: 0,
        replyMsgTime: 0,
        receiverUid: 0,
        replyMsgContent: "",
        replySenderNick: "",
        replyMessage: null,
    },
    // æ­£æ–‡
    {
        senderId: "",
        receiverId: "",
        messageId: "7559957795182421206",
        messageType: 1,
        messageText: "åªèƒ½è¯´èƒ½æ´—å¹²å‡€é¼»æ¶•",
        replyMsgId: "0",
        replyMsgSeq: 0,
        replyMsgTime: 0,
        receiverUid: 0,
        replyMsgContent: "",
        replySenderNick: "",
        replyMessage: null,
    }
];
```
